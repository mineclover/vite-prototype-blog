---
date: 2023-05-04
modified: 2023-05-05
---

```dataview
LIST "File Path: " + file.path
WHERE date(file.frontmatter.date) > date(2023-05-04) - dur(1 day) AND date(file.frontmatter.date) < date(2023-05-04) + dur(1 day)
```

[2023-05-04 daily tech note](/topic/tech-review/T2023-05-04/T2023-05-04)

## 한 일

[db-setting](../../../project/traffic-test-base/db-setting/db-setting)
자동 라우팅 [vite-automatic-routing](../../../work/vite/vite-automatic-routing) 모듈화 해서 적용

### 작업 중인 음식점 프로젝트에 대한 상황 공유

![](file/2023-05-04.png)
검색을 태그 방식으로필터링해서 검색한다고 한다
어떻게 검색할 수 있을까
우선 세가지 속성이 모두 충족하는 테이블을 찾아야한다
문제는 중복 된 쿼리를 어떻게 찾는지 정보가 애매하다

#### 백앤드 분한테 수소문

테이블을 좀 쪼개서 한번에 찾을 수 있도록 하는 것을 권장받았다
레퍼런스 참고도 하라고 함
[ERDCloud](https://www.erdcloud.com/)

#### 그래서 생각해본

테이블을 많이 나누라고 했으니까
특정 범주의 특정 속성을 가지는 테이블을 만들고
그 안에 값을 넣어서 하는 방식

일 대 일 매칭되는 테이블에 고유키를 외래키로 뽑아서 다른 테이블에서 쓸 수 있도록 사용하고
속성별로 테이블을 또 만들어서 속성별 테이블에서 쿼리를 수행하도록 한다

여전히 모르겠는 부분은 원자값이 아니게 반 정규화하면 많이 불편한가 라는 생각
정규화된 테이블로 실시간 연동되는 반 정규화 테이블 같은 걸 구성하는게 가능한지

그저 참조가 아니라 연쇄 동작을 일으켜야하는데 어떻게 할지
이 연쇄 동작을 처리하는걸... [edge-function](../../../back/supabase/edge-function/edge-function) 으로 처리하거나

그냥 속성별로 테이블을 완전히 분리하고, 위치 별 고유키만 공유하는 상태에서 프론트에서 이들을 배치해서 쓰는 방법도 괜찮아보인다
`key-value` 인 점을 활용해서 set 객체처럼 특정 키가 겹치지 않는 것을 이용해서
하나의 객체로 만들거나 set 을 활용하는 방식

```
obj = { 3: 3 , 0: 0 , 1: 1, 5:5 ,2:2 , 4: 4}
{0: 0, 1: 1, 2: 2, 3: 3, 4: 4, 5: 5}
```

DB 에서는 속성별로 원자값으로 저장해서 관리하기
그런데...
특정 테이블에서 본인을 참조하고 있는 객체가 가진 속성을 본인의 속성에 집계함수 등으로 통계를 내는 것이 가능한가...
이게 좀 어렵다
또는 값을 받기 위해서 분리되어 있는 본인의 모든 속성을 어떻게 가져오는지...
요청을 여러번 보내는 거 말고
하나로 뭉쳐진 테이블을 만드는 방법이 .. 뭘까?

**가져올 떄는 Form 에서 여러개 불러오고 select 에서 Table.Attributes 하고 찾아진 ID 로 모든 테이블 값 가져오면 된다 **

조회할 때는 ... 테이블 단위로 교집합 찾기?

하 어렵네.. 개념이 부족하다

whrere 절에 외부 쿼리를 붙이는 등 복잡한 것에 대해서도 고려할 수 있다 supabase 에 어떻게 붙일지 조금 막막했다

이부분은 책오면 책보고 하자

### 카카오 로그인 OAUTH

이걸로 하면 uuid 가 생긴다
고유 아이디가 겹치면 어떡하지 라는 생각을 했지만 uuid 가 겹칠일은 3400 년 후에나 생길것이라고 하니 일단 사용해도 될 것 같다

[098 고유한 식별자를 만들려면? ― uuid - 점프 투 파이썬 - 라이브러리 예제 편](https://wikidocs.net/131351)
uuid 를 받고 그걸로 로그인 시키는 로직을 만들 수 있을 것 같다
카카오 로그인여서 조금 문제인 것이 있긴 한데
하나의 계정을 멀티로 인증할 수 있느냐 라는 것
인증 형식을 수정할 수 있는지 찾아봐야할 것 같다

우어 supabase 에 카카오로그인 붙이려하는데
카카오 로그인 반환값을 확인 안해봤지만 고유 이메일과 고유키를 반환한다면 그 값으로 이메일과 고유키를 아이디 비밀번호로 설정하려하고 있습니당
그런데 카카오 로그인된 아이디가 비밀번호를 수정한 후에 카카오로그인을 다시시도하면 어떻게 처리해야할지 잘 모르겠네요 ㅠㅠ
auth 에 접근하는게 제한적인 것으로 알고 있어서 ... 그냥 카카오 회원가입으로 이름을 바꿔야하는가...
아니면 별도 테이블로 고유키를 관리하고 인증되었을 경우 페이지를 리디렉션 시키거나 비밀번호를 전송시켜야 하는가...
비밀번호를 클라이언트로 전송하게 되면 노출되는건데 이게 괜찮은가... 여러가지 생각이 드네요 매직링크 리디렉션이 가장 보안 상 문제가 적어보이긴 하는데
supabase 에서 어떻게 리디렉션 시킬 수 있을지가 고민이네
아 그냥 리디렉션 URL 주고 실행시키면 되겠다 캬

### vite 자동 라우팅

[vite-automatic-routing](../../../work/vite/vite-automatic-routing)

## 목표 설정
